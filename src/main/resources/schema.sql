DROP TABLE IF EXISTS EMPTY cascade;
--
DROP TABLE IF EXISTS booking cascade;
DROP TABLE IF EXISTS item cascade;
DROP TABLE IF EXISTS users cascade;
DROP TABLE IF EXISTS users_item_list cascade;
DROP TABLE IF EXISTS comment cascade;

-- Таблица users
CREATE TABLE users
(
    id    BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR(255) NOT NULL unique ,
    name  VARCHAR(255) NOT NULL
);

-- Таблица item
CREATE TABLE item
(
    id          BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    available   BOOLEAN NOT NULL,
    description VARCHAR(255),
    name        VARCHAR(255),
    owner       BIGINT,
    renter      BIGINT,
    request_id  BIGINT
);


-- Таблица item_request
CREATE TABLE item_request
(
    id           BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    created      TIMESTAMP,
    description  VARCHAR(255),
    requestor_id BIGINT
);

-- Таблица users_item_list
CREATE TABLE users_item_list
(
    user_id      BIGINT NOT NULL,
    item_list_id BIGINT NOT NULL
);

-- Таблица booking
CREATE TABLE booking
(
    id            BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    booking_end   TIMESTAMP,
    booking_start TIMESTAMP,
    status        VARCHAR(255),
    booker_id     BIGINT,
    item_id       BIGINT ,
    owner_id      BIGINT
);

-- Таблица comment
CREATE TABLE comment
(
    id        BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    created   TIMESTAMP,
    text      VARCHAR(255),
    author_id BIGINT,
    item_id   BIGINT
);


ALTER TABLE item ADD CONSTRAINT FKKES9T8SA18FSSXSM7MSSYIDG1 FOREIGN KEY (owner) REFERENCES users;
ALTER TABLE item ADD CONSTRAINT FK1YVTSLFLVXOT723MS8GUQUB84 FOREIGN KEY (renter) REFERENCES users;
ALTER TABLE item ADD CONSTRAINT FKSSMVX88R64SMPV06P2UM3QEUX FOREIGN KEY (request_id) REFERENCES item_request;
ALTER TABLE booking ADD CONSTRAINT FKF8QQD65QC077MRBDOG4R9LDC3 FOREIGN KEY (booker_id) REFERENCES users;
ALTER TABLE booking ADD CONSTRAINT FKIKWXUL5WTB263VQOGGTKLSY5W FOREIGN KEY (item_id) REFERENCES item;
ALTER TABLE booking ADD CONSTRAINT FK_H5HE40UEOK38ABD11IX5K6TAM FOREIGN KEY (owner_id) REFERENCES users;
ALTER TABLE item_request ADD CONSTRAINT FKNS8UIYPW7UTNBNBDCI8NN738A FOREIGN KEY (requestor_id) REFERENCES users;
ALTER TABLE users_item_list ADD CONSTRAINT FK12GH6L8YX73E4F218UW6F5CB4 FOREIGN KEY (user_id) REFERENCES users;
ALTER TABLE users_item_list ADD CONSTRAINT FK21HY5E423NVNOVEXTT5756OIO FOREIGN KEY (item_list_id) REFERENCES item;
ALTER TABLE comment ADD CONSTRAINT FKIR20VHRX08EH4ITGPBFXIP0S1 FOREIGN KEY (author_id) REFERENCES users;
ALTER TABLE comment ADD CONSTRAINT FK_IHMV7Q173GQI1XQGTSVW4S96M FOREIGN KEY (item_id) REFERENCES item;
